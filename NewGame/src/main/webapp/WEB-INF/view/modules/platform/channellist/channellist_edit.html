@layout("/common/_container.html"){
<!-- PAGE CONTENT BEGINS -->
<div class="row">
    <div class="col-xs-12 tb-grid">
        <form data-url="${ctxPath}/channellist/update" method="post" class="form-horizontal" role="form">
            <input type="hidden" name="channellist.id" value="${channellist.id}" readonly/>
            <table class="table table-bordered">
                <tbody>
                <tr>
                    <td style="vertical-align: middle !important;text-align:right;" class="bg-F5F5F5">商户名: </td>
                    <td>
                        <input type="hidden" id="mcId" value="${channellist.chPoolId}" readonly/>
                        <select type="text" id="ChannelID" name="channellist.chPoolId"></select>
                        <input type="hidden" id="cid" name="channellist.chName" value="${channellist.chName}"/>
                    </td>
                </tr>

                <tr>
                    <td style="vertical-align: middle !important;text-align:right;" class="bg-F5F5F5">包来源: </td>
                    <td>
                        <input type="hidden" id="clientType" value="${channellist.clientType}"/>
                        <select id="clientTypes" name="channellist.clientType"></select>
                    </td>
                <tr/>

                <tr>
                    <td style="vertical-align: middle !important;text-align:right;" class="bg-F5F5F5">是否开启: </td>
                    <td>
                        <input type="radio" name="channellist.isOpen" value="1" ${channellist.isOpen==1?"checked":""}>开启</input>&nbsp;&nbsp;
                        <input type="radio" name="channellist.isOpen" value="0" ${channellist.isOpen==0?"checked":""}>关闭</input>
                    </td>
                </tr>
                </tbody>
            </table>
        </form>
    </div>
</div>
<script>
    $("#ChannelID").change(function () {
        var text = $("#ChannelID").find("option:selected").text();
        // console.log(text.split("-")[1])
        $("#cid").val(text.split("-")[1])
    })
    var ctx="${ctxPath}";
    $(function (){
        new Ajax(ctx + "/channellist/getChannel", function (data) {
            if(data.code === 0 && BladeTool.isNotEmpty(data.data)) {
                var type = data.data;
                var mcId = parseInt($("#mcId").val())
                var html = '';
                for (var i = 0; i < type.length; i++) {
                    var temp = type[i]['id']
                    console.log(mcId,temp)
                    if (mcId===temp){
                        html='<option value="' + temp + '">' + type[i]['name'] + '</option>'+html;
                    }else {
                        html += '<option value="' + temp + '">' + type[i]['name'] + '</option>';
                    }
                }
                $("#ChannelID").html(html);
            }
        }).start();
    })
    // 获取包来源列表
    new Ajax("${ctxPath}/newsplatform/getPlatformInfo", function (data) {
        console.log(data);
        if(data.code === 0 && BladeTool.isNotEmpty(data.data)) {
            var type = data.data;
            var html = '';
            var clientType = parseInt($("#clientType").val())
            for (var i = 0; i < type.length; i++) {
                var temp=type[i]['clientType']
                if (temp===clientType){
                    html = '<option value="' + temp + '">' + type[i]['name'] + '</option>'+html;
                }else {
                    html += '<option value="' + temp + '">' + type[i]['name'] + '</option>';
                }
            }
            $("#clientTypes").html(html);
        }
    }).start();
</script>
<!-- 按钮 -->
@ include("/common/_curd/_btn.html",{btn_save:"确认修改",btn_close:"关闭"}) {}
@}